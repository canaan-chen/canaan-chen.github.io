<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>hexo next 主题优化 | 这里可能有你遇到所有问题的答案 | UncleFish&#39;s Blog</title>
<link rel="shortcut icon" href="https://unclefish-cc.github.io/favicon.ico?v=1586708453912">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://unclefish-cc.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="hexo next 主题优化 | 这里可能有你遇到所有问题的答案 | UncleFish&#39;s Blog - Atom Feed" href="https://unclefish-cc.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="hello 大家好，我是鱼叔。我最近花了两天左右的时间基于hexo和next搭建了个人的blog（传输门），中途遇到了一堆的bug以及相关的优化问题，想写这篇文章记录下来给想搭建blog的你一个参考。

搭建blog的初衷
现在网络平台里有..." />
    <meta name="keywords" content="hexo" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://unclefish-cc.github.io">
  <img class="avatar" src="https://unclefish-cc.github.io/images/avatar.png?v=1586708453912" alt="">
  </a>
  <h1 class="site-title">
    UncleFish&#39;s Blog
  </h1>
  <p class="site-description">
    Never give up, and you will see hope.
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          Home
        </a>
      
    
      
        <a href="/archives" class="menu">
          Archives
        </a>
      
    
      
        <a href="/tags" class="menu">
          Tags
        </a>
      
    
      
        <a href="/about" class="menu">
          About
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              hexo next 主题优化 | 这里可能有你遇到所有问题的答案
            </h2>
            <div class="post-info">
              <span>
                2020-03-19
              </span>
              <span>
                10 min read
              </span>
              
                <a href="https://unclefish-cc.github.io/xE65R6X5lg/" class="post-tag">
                  # hexo
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://image-1301586523.cos.ap-shanghai.myqcloud.com/way-4005288_1280.jpg" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <p>hello 大家好，我是鱼叔。我最近花了两天左右的时间基于hexo和next搭建了个人的blog（传输门），中途遇到了一堆的bug以及相关的优化问题，想写这篇文章记录下来给想搭建blog的你一个参考。</p>
<!--more-->
<h2 id="搭建blog的初衷">搭建blog的初衷</h2>
<p>现在网络平台里有很多可以发表个人看法的平台，比如我派，比如知乎、简书等，那花费功夫搭建自己的个人blog到底有什么意义呢？在我看来，个人博客的意义在于自由性，因为这是你自己的平台，你可以自由地去发表个人想法和文章，而不用担心内容是否迎合具体某个平台的读者。其次，我将个人博客作为自己的一个分享型知识记录，我希望自己的经历或者知识可以给别人带来一点启发和帮助，也许某一个瞬间，当一个人在搜寻相关的知识，参考了你博客的内容并且留言感时，你会发现自己其实在给这个社会做贡献，你在无声中被别人所认可。</p>
<h2 id="相关的优化">相关的优化</h2>
<h3 id="前言">前言</h3>
<ul>
<li>关于hexo</li>
</ul>
<p>我所搭建的blog是基于hexo + GitHub的，因为hexo凭借它轻便快捷的特点，已经成为现在个人博客搭建的主流。我派已经有较为具体的搭建教程文章了，就不再详述搭建步骤。</p>
<p><a href="https://sspai.com/post/59337">https://sspai.com/post/59337</a></p>
<ul>
<li>关于NexT</li>
</ul>
<p>NexT 是hexo主题中非常流行的一个，因为它功能齐全，而且插件丰富，成为大多数人的首选主题。当然流行就会出现一个问题，很容易撞车，大家的博客外表都非常相似。不过鱼叔认为博客只是载体，内容才是王道，所以在精力有限的情况下，没必要太纠结于博客外表的华丽，找一个顺眼的主题驻扎即可。本文接下去的内容也主要适用于NexT主题。</p>
<figure data-type="image" tabindex="1"><img src="https://image-1301586523.cos.ap-shanghai.myqcloud.com/20200318145642.png" alt="next 主题样式" loading="lazy"></figure>
<h3 id=""></h3>
<h3 id="-2"></h3>
<h3 id="菜单栏修改问题">菜单栏修改问题</h3>
<p>Next在主题的_config.yml文件中提供菜单栏的修改，只要搜索menu就可以找到，通过去除注释即可以在网页上进行渲染。然而鱼叔在修改next中的menu时会发现存在这样的报错 “cannot get %20” -- 无法找到相应的菜单。出现的原因是官方给的代码中多加了一个空格，导致网页无法渲染，个人除了删除注释外，要将“||”前的空格删除不然会导致菜单没法跳转。</p>
<pre><code class="language-yml">menu:
  home: /|| home
  about: /about/|| user
  tags: /tags/|| tags
  categories: /categories/|| th
  archives: /archives/|| archive
  #schedule: /schedule/ || calendar #官方给的代码 || 前多加了空格
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://image-1301586523.cos.ap-shanghai.myqcloud.com/20200318150930.png" alt="" loading="lazy"></figure>
<h3 id="hexo博客出现cannot-gettags-or-categories错误">Hexo博客出现“Cannot GET/tags or categories”错误</h3>
<p>next提供了标签和分类功能，但是在实现这个功能时常常会遇到&quot;cannot get&quot; 的问题，这是因为我们没有对它们进行初始化。具体解决方法如下：</p>
<ol>
<li>
<p>在git bash 中输入以下代码创建相应的page：</p>
<pre><code class="language-python">hexo new page &quot;tags&quot;
hexo new page &quot;categories&quot;
</code></pre>
</li>
<li>
<p>在第一步完成后会在source文件夹中出现tags和categories的文件夹，在各自的文件夹里打开index.md文件进行修改(多加上一个type属性)：</p>
<pre><code class="language-markdown">title: categories
date: 2020-03-15 14:19:53
type: &quot;categories&quot;

title: tags
date: 2020-03-15 14:20:32
type: &quot;tags&quot;
</code></pre>
</li>
</ol>
<h3 id="底部下一页跳转问题">底部下一页跳转问题</h3>
<p>鱼叔在建立博客的时候发现底部下一页跳转按钮没有正常显示，如下图</p>
<figure data-type="image" tabindex="3"><img src="https://image-1301586523.cos.ap-shanghai.myqcloud.com/fsfsfewf.png" alt="" loading="lazy"></figure>
<p>修改方式：</p>
<p>打开主题 layout/_partials/pagination.swg 进行修改，将“i class”模块删除修改成如下模式(其中prev 和 next可以自定字样)：</p>
<pre><code class="language-python">{% if page.prev or page.next %}
  &lt;nav class=&quot;pagination&quot;&gt;
    {{
      paginator({
        prev_text: 'prev',
        next_text: 'next',
        mid_size: 1
      })
    }}
  &lt;/nav&gt;
{% endif %}
</code></pre>
<p>修改后结果为下图，实现正常的跳转按钮：</p>
<figure data-type="image" tabindex="4"><img src="https://image-1301586523.cos.ap-shanghai.myqcloud.com/ljoifowenfewnf.png" alt="" loading="lazy"></figure>
<h3 id="如何让首页文章部分显示">如何让首页文章部分显示</h3>
<p>next主题默认的是将你的文章全篇显示在自己的首页上，这就会导致一个问题，首页各个文章太长了不利于翻阅，那如何部分显示自己的文章呢？很简单，只要在个人的文章Markdown 中在想要显示的文章部分下面加上代码<code>&lt;!--more&gt;</code>，即可只在首页显示所需的文章部分。</p>
<h3 id="修改头像问题">修改头像问题</h3>
<p>将自己的头像复制到blog文件夹中的\themes\next\source\images中覆盖原来的avatar.png 文件即可。</p>
<h3 id="修改站点icon">修改站点icon</h3>
<p>当套用完next主题后，个人博客的站点图标会自动为next的logo，作为博主当然不能忍这个logo啦，那怎么修改呢？</p>
<p>我们打开next的主题配置文件会发现有这样的设定：</p>
<pre><code class="language-yml">favicon:
  small: /images/favicon-16x16-next.png
  medium: /images/favicon-32x32-next.png
  apple_touch_icon: /images/apple-touch-icon-next.png
  safari_pinned_tab: /images/logo.svg
</code></pre>
<p>这就可以很清晰地发现去哪里修改了，只要在对应的路径上把原有的图片文件给替换成我们需要的文件就行了。这里给大家提供一个网站用于生成所需的icon同尺寸图像：<a href="https://www.favicon-generator.org/">https://www.favicon-generator.org/</a></p>
<h3 id="增加阅读时长和字数统计功能">增加阅读时长和字数统计功能</h3>
<p>next自带阅读时长和字数统计插件，我们所需要做的就是调用这两个工具。首先在主题的配置文件中修改：</p>
<pre><code class="language-yml">post_wordcount:
  item_text: true
  wordcount: true         # 单篇 字数统计
  min2read: true          # 单篇 阅读时长
  totalcount: false       # 网站 字数统计
  separated_meta: true
</code></pre>
<p>完成配置后，我们需要安装word-count 插件，在git bash中输入：</p>
<pre><code>npm i --save hexo-wordcount
</code></pre>
<p>完成插件安装后，为了更好的显示，我们可以打开xxx_blog/themes/next/layout/_macro/post.swig ，在对应地方添加字words 和 min。可以通过搜索‘wordcount’ 和 ‘min2read’ 来定位。</p>
<pre><code> &lt;span title=&quot;{{ __('post.wordcount') }}&quot;&gt;
                  {{ wordcount(post.content) }} words
                &lt;/span&gt;
         
           &lt;span title=&quot;{{ __('post.min2read') }}&quot;&gt;
                  {{ min2read(post.content) }} min
                &lt;/span&gt;
</code></pre>
<h3 id="配置搜索功能">配置搜索功能</h3>
<p>next自带一个搜索功能，可以实现对站内内容的搜索。</p>
<p>首先需要通过如下命令安装对应的搜索插件：</p>
<p>然后在全局的配置文件（hexoblog目录下的_config.yml）中，增加配置如下内容：</p>
<pre><code class="language-yml"># Search Config
search:
  path: search.xml
  field: post
  format: html
  limit: 100
</code></pre>
<p>然后在git hash 中加载相应的插件：</p>
<pre><code>npm install hexo-generator-search --save
npm install hexo-generator-searchdb --save
</code></pre>
<p>打开主题内的配置文件，找到 local_search 属性，配置开启本地搜索功能。</p>
<pre><code class="language-yml">local_search:
  enable: true
  # if auto, trigger search by changing input
  # if manual, trigger search by pressing enter key or search button
  trigger: auto
  # show top n results per article, show all results by setting to -1
  top_n_per_article: 1
</code></pre>
<h3 id="将自己的博客收录到谷歌搜索中">将自己的博客收录到谷歌搜索中</h3>
<p>为了让自己的博客能被更多人搜索到，自然需要将自己的博客收录到谷歌引擎中，具体的操作如下：</p>
<ol>
<li>添加资源</li>
</ol>
<p>打开<a href="https://search.google.com/search-console?hl=zh">Google search Console</a>, 在左上角添加资源：</p>
<figure data-type="image" tabindex="5"><img src="https://image-1301586523.cos.ap-shanghai.myqcloud.com/20200318161417.png" alt="" loading="lazy"></figure>
<ol start="2">
<li>网址验证</li>
</ol>
<p>选择网址前缀输入自己的博客网址。接下去就是对网站的验证，即证明网站是自己的。google 提供了多种方式进行验证，比较方便的是HTML 文件方式，它会产生一个HTML 文件，你只要将它放到博客source里然后再进行重新部署就行,（tips: 为了避免验证文件被hexo渲染，可以在验证html里添加‘layout：false’ 代码）。鱼叔采用的是HTML标记的方式，具体的方法就是将google提供的代码copy到 xxx_blog/themes/next/layout/_partials/head.swig中，放在头部的<meta>下面即可。</p>
<figure data-type="image" tabindex="6"><img src="https://image-1301586523.cos.ap-shanghai.myqcloud.com/20200318161752.png" alt="" loading="lazy"></figure>
<ol start="3">
<li>
<p>增加sitemap</p>
<p>通过在线网址 <a href="https://www.xml-sitemaps.com/">sitemap</a>生成自己博客的站点地图，然后将站点地图下载下来放到自己博客源public文件夹中（xxx_blog/public）。然后打开 Google console，点开左侧的添加站点地图，输入sitemap.xml，点击提交即可，一般会花2-3天时间进行收录。</p>
<figure data-type="image" tabindex="7"><img src="https://image-1301586523.cos.ap-shanghai.myqcloud.com/20200319115742.png" alt="" loading="lazy"></figure>
</li>
</ol>
<h3 id="增加评论功能">增加评论功能</h3>
<p>目前比较流行的两种评论系统是Valine 和 Giement，这里主要讲Valine的配置。</p>
<ol>
<li>
<p>注册leancloud， <a href="https://leancloud.cn/dashboard/login.html#/signin">leancloud注册网址</a></p>
</li>
<li>
<p>注册登陆后，访问控制台，创建应用，选择开发版，创建好之后就生成了对应的id和key</p>
<figure data-type="image" tabindex="8"><img src="https://image-1301586523.cos.ap-shanghai.myqcloud.com/20200319121641.png" alt="" loading="lazy"></figure>
</li>
<li>
<p>在主题配置文件中进行修改</p>
<pre><code> Valine.
# You can get your appid and appkey from https://leancloud.cn
# more info please open https://valine.js.org
valine:
  enable: true 
  appid:   # 填入 App ID
  appkey:  # 填入 App Key
  notify: false 
  verify: false #
  placeholder: 请在此输入您的留言 # 默认留言框内的文字
  avatar: &quot;&quot; # 修改留言者头像，具体代码可以参考valine官网
  guest_info: nick,mail # 默认留言框的头部需要访问者输入的信息
  pageSize: 10 #默认单页的留言条数
</code></pre>
</li>
<li>
<p>最后效果</p>
<figure data-type="image" tabindex="9"><img src="https://image-1301586523.cos.ap-shanghai.myqcloud.com/20200319122124.png" alt="" loading="lazy"></figure>
</li>
</ol>
<h3 id="博客中图床问题">博客中图床问题</h3>
<p>这里推荐图床神器PicGo, 可以非常快捷地将图片上传到自己所需的云端中，而我采用的是PicGo结合腾讯云COS来搭建在线个人图床。</p>
<p>相关的教程链接：<a href="https://sspai.com/post/59284">https://sspai.com/post/59284</a></p>
<h2 id="总结">总结</h2>
<p>基本上讲完了我搭建博客时遇到的所有问题，我之前看过一个博主写的一句话，“搭建博客就像玩了一个游戏，你的博客就是你的角色，你总是会想方设法地给他升级“。博客优化其实是一个无止境的路，需要耐心和时间，但往往我们会过度的为了美化它而忘记了自己搭建的初衷。好的内容才是一个博客真正的灵魂。</p>
<h2 id="参考">参考</h2>
<p><a href="https://theme-next.iissnan.com/theme-settings.html">Next 官方指南</a></p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E6%90%AD%E5%BB%BAblog%E7%9A%84%E5%88%9D%E8%A1%B7">搭建blog的初衷</a></li>
<li><a href="#%E7%9B%B8%E5%85%B3%E7%9A%84%E4%BC%98%E5%8C%96">相关的优化</a>
<ul>
<li><a href="#%E5%89%8D%E8%A8%80">前言</a></li>
<li></li>
<li></li>
<li><a href="#%E8%8F%9C%E5%8D%95%E6%A0%8F%E4%BF%AE%E6%94%B9%E9%97%AE%E9%A2%98">菜单栏修改问题</a></li>
<li><a href="#hexo%E5%8D%9A%E5%AE%A2%E5%87%BA%E7%8E%B0cannot-gettags-or-categories%E9%94%99%E8%AF%AF">Hexo博客出现“Cannot GET/tags or categories”错误</a></li>
<li><a href="#%E5%BA%95%E9%83%A8%E4%B8%8B%E4%B8%80%E9%A1%B5%E8%B7%B3%E8%BD%AC%E9%97%AE%E9%A2%98">底部下一页跳转问题</a></li>
<li><a href="#%E5%A6%82%E4%BD%95%E8%AE%A9%E9%A6%96%E9%A1%B5%E6%96%87%E7%AB%A0%E9%83%A8%E5%88%86%E6%98%BE%E7%A4%BA">如何让首页文章部分显示</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E5%A4%B4%E5%83%8F%E9%97%AE%E9%A2%98">修改头像问题</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E7%AB%99%E7%82%B9icon">修改站点icon</a></li>
<li><a href="#%E5%A2%9E%E5%8A%A0%E9%98%85%E8%AF%BB%E6%97%B6%E9%95%BF%E5%92%8C%E5%AD%97%E6%95%B0%E7%BB%9F%E8%AE%A1%E5%8A%9F%E8%83%BD">增加阅读时长和字数统计功能</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD">配置搜索功能</a></li>
<li><a href="#%E5%B0%86%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2%E6%94%B6%E5%BD%95%E5%88%B0%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2%E4%B8%AD">将自己的博客收录到谷歌搜索中</a></li>
<li><a href="#%E5%A2%9E%E5%8A%A0%E8%AF%84%E8%AE%BA%E5%8A%9F%E8%83%BD">增加评论功能</a></li>
<li><a href="#%E5%8D%9A%E5%AE%A2%E4%B8%AD%E5%9B%BE%E5%BA%8A%E9%97%AE%E9%A2%98">博客中图床问题</a></li>
</ul>
</li>
<li><a href="#%E6%80%BB%E7%BB%93">总结</a></li>
<li><a href="#%E5%8F%82%E8%80%83">参考</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://unclefish-cc.github.io/关于我为什么要去新加坡留学/">
              <h3 class="post-title">
                新加坡留学 | 关于我为什么要去新加坡留学
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://unclefish-cc.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
